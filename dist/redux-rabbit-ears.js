!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n(require("window")):"function"==typeof define&&define.amd?define(["window"],n):e.ReduxRabbitEars=n(e.window)}(this,function(e){"use strict";var n="@@redux-rabbit-ears/CHANNEL",t=(e=e&&e.hasOwnProperty("default")?e.default:e).browser||e.chrome,r=Object.assign||function(e){for(var n=1;arguments.length>n;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},o="@@redux-rabbit-ears/BROADCAST";return{CHANNEL:n,createExtensionMiddleware:function(e,i){return t&&t.runtime?"string"!=typeof e?(console.error("Expected extensionId"),function(){return function(e){return function(n){return e(n)}}}):function(c){var u=t.runtime.connect(e,{name:n}),s=!0;return u.onMessage.addListener(function(e){console.log(e),e.meta&&e.meta.type===o&&c.dispatch(e)}),u.onDisconnect.addListener(function(){s=!1,console.warn("redux-rabbit-ears has disconnected from chrome-extension://"+e)}),i&&i(u),function(e){return function(n){return s&&!(n.meta&&n.meta.type===o)&&u.postMessage(r({},n,{meta:{type:o}})),e(n)}}}:(console.error("Expected {browser, chrome}.runtime to exist"),function(){return function(e){return function(n){return e(n)}}})},createExtensionBackgroundProxy:function(){var e=[];t.runtime.onConnect.addListener(function(t){t.name===n&&(e.push(t),t.onDisconnect.addListener(function(){var n=e.indexOf(t);e.splice(n,1)}),t.onMessage.addListener(function(n){e.forEach(function(e){e!==t&&e.postMessage(n)})}))})}}});
